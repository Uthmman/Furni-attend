
{
  "entities": {
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents a furniture order.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the order."
        },
        "customerName": {
          "type": "string",
          "description": "Name of the customer who placed the order."
        },
        "orderDate": {
          "type": "string",
          "description": "Date the order was placed.",
          "format": "date-time"
        },
        "orderDescription": {
          "type": "string",
          "description": "Description of the order."
        },
        "orderStatus": {
          "type": "string",
          "description": "Status of the order (e.g., pending, processing, completed)."
        },
        "productPictureUrl": {
          "type": "string",
          "description": "URL of the product picture associated with the order.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "customerName",
        "orderDate",
        "orderStatus"
      ]
    },
    "Item": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Item",
      "type": "object",
      "description": "Represents a furniture item in the store.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the item."
        },
        "name": {
          "type": "string",
          "description": "Name of the item."
        },
        "unitOfMeasurement": {
          "type": "string",
          "description": "Unit of measurement for the item (e.g., piece, set)."
        },
        "stockLevel": {
          "type": "number",
          "description": "Number of items currently in stock."
        }
      },
      "required": [
        "id",
        "name",
        "unitOfMeasurement",
        "stockLevel"
      ]
    },
    "StockAdjustment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StockAdjustment",
      "type": "object",
      "description": "Represents an adjustment to the stock level of an item.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the stock adjustment."
        },
        "itemId": {
          "type": "string",
          "description": "Reference to Item. (Relationship: Item 1:N StockAdjustment)"
        },
        "adjustmentDate": {
          "type": "string",
          "description": "Date the stock adjustment was made.",
          "format": "date-time"
        },
        "adjustmentQuantity": {
          "type": "number",
          "description": "Quantity of items added or removed from stock (can be positive or negative)."
        },
        "reason": {
          "type": "string",
          "description": "Reason for the stock adjustment."
        }
      },
      "required": [
        "id",
        "itemId",
        "adjustmentDate",
        "adjustmentQuantity",
        "reason"
      ]
    },
    "Employee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Employee",
      "type": "object",
      "description": "Represents an employee of the company.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the employee."
        },
        "phoneNumber": {
          "type": "string",
          "description": "Employee's phone number."
        },
        "paymentMethod": {
          "type": "string",
          "description": "Payment method (e.g., weekly, monthly)."
        },
        "accountNumber": {
          "type": "string",
          "description": "Employee's bank account number."
        },
        "attendanceStartDate": {
          "type": "string",
          "description": "The date the employee's attendance tracking should start.",
          "format": "date"
        }
      },
      "required": [
        "id",
        "phoneNumber",
        "paymentMethod",
        "accountNumber",
        "attendanceStartDate"
      ]
    },
    "Attendance": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Attendance",
      "type": "object",
      "description": "Represents an employee's attendance record for a specific date.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the attendance record."
        },
        "employeeId": {
          "type": "string",
          "description": "Reference to Employee. (Relationship: Employee 1:N Attendance)"
        },
        "attendanceDate": {
          "type": "string",
          "description": "Date of the attendance record.",
          "format": "date-time"
        },
        "morningEntryTime": {
          "type": "string",
          "description": "Time the employee entered in the morning.",
          "format": "date-time"
        },
        "afternoonEntryTime": {
          "type": "string",
          "description": "Time the employee entered in the afternoon.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Attendance status (e.g., present, absent, late)."
        }
      },
      "required": [
        "id",
        "employeeId",
        "attendanceDate",
        "status"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/employees/{employeeId}",
        "definition": {
          "entityName": "Employee",
          "schema": {
            "$ref": "#/backend/entities/Employee"
          },
          "description": "Stores all employee information for the application. This collection should be readable and writable by any authenticated user for the purpose of this internal tool.",
          "allow": "read, write: if request.auth != null;",
          "params": [
            {
              "name": "employeeId",
              "description": "Unique identifier for the employee."
            }
          ]
        }
      },
      {
        "path": "/employees/{employeeId}/attendance/{attendanceId}",
        "definition": {
          "entityName": "Attendance",
          "schema": {
            "$ref": "#/backend/entities/Attendance"
          },
          "description": "Stores all attendance records for each employee. Access should be granted to authenticated users who need to manage or view attendance data.",
          "allow": "read, write: if request.auth != null;",
          "params": [
            {
              "name": "employeeId",
              "description": "Unique identifier for the employee."
            },
            {
              "name": "attendanceId",
              "description": "Unique identifier for the attendance record."
            }
          ]
        }
      },
      {
        "path": "/attendance/{date}/records/{employeeId}",
        "definition": {
          "entityName": "Attendance",
          "schema": {
            "$ref": "#/backend/entities/Attendance"
          },
          "description": "Stores attendance records for a specific date, used for daily logging. Authenticated users should have full access.",
          "allow": "read, write: if request.auth != null;",
          "params": [
            {
              "name": "date",
              "description": "The date of the records in YYYY-MM-DD format."
            },
            {
              "name": "employeeId",
              "description": "Unique identifier for the employee."
            }
          ]
        }
      }
    ],
    "reasoning": "To resolve persistent permission issues and facilitate rapid development, the security rules are being simplified. This new structure allows any authenticated user to read and write to the specified collections. This is a deliberate choice to unblock development and ensure the application is functional for internal use, where all authenticated users are considered trusted. This approach grants full access to logged-in users, effectively making the database public to them while keeping it private from unauthenticated access."
  }
}
